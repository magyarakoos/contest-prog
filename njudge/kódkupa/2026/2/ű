#include <bits/stdc++.h>
using namespace std;
#define int int64_t

const int INF = 1e18, MAXN = 2e5, MOD = 1e9 + 7;

#define cases 0
void solve() {
    int n;
    cin >> n;
    vector<int> k(n), p(n), w(n);
    for (int i = 0; i < n; i++) cin >> k[i];
    for (int i = 1; i < n; i++) cin >> p[i];
    for (int i = 1; i < n; i++) cin >> w[i];
    vector<vector<array<int, 2>>> g(n + 1);
    for (int i = 1; i < n; i++) {
        g[p[i]].push_back({i, w[i]});
    }

    vector<array<int, 2>> dp(n);
    function<void(int)> dfs = [&](int u) {
        if (g[u].empty()) return;
        vector<array<int, 2>> plus(g[u].size());
        for (int i = 0; i < g[u].size(); i++) {
            auto [v, w] = g[u][i];
            dfs(v);
            plus[i] = {dp[v][1] + w, v};
        }
        vector dp2(k[u] + 1, vector<int>(g[u].size()));
        for (int i = 0; i < g[u].size(); i++) {
            dp2[0][i] = (i ? dp2[0][i - 1] : 0);
            for (int j = 1; j <= k[u]; j++) {
                dp2[j][i] =
                    max((i ? dp2[j][i - 1] : 0) +
                            dp2[0][g[u][i][0]],
                        (i ? dp2[j - 1][i - 1] : 0) +
                            plus[i][0]);
            }
        }
        // sort(plus.rbegin(), plus.rend());
        cout << u << " | ";
        cout << k[u] - 1 << endl;
        dp[u][0] = *max_element(dp2[k[u]].begin(),
                                dp2[k[u]].end());
        dp[u][1] = *max_element(dp2[k[u] - 1].begin(),
                                dp2[k[u] - 1].end());
        cout << dp[u][0] << " " << dp[u][1] << "\n";
    };

    dfs(0);
    // for (int i = 0; i < n; i++) {
    //     cout << dp[i][0] << " " << dp[i][1] << "\n";
    // }
    // cout << dp[0][0] << "\n";
}

int32_t main() {
    cin.tie(0), ios::sync_with_stdio(0);
    int T = 1;
    if (cases) cin >> T;
    while (T--) solve();
}
